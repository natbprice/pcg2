"0",""
"0","# Load data"
"0","data(""largedemodata"")"
"0",""
"0","# Build dataframe"
"0","largeEx <-"
"0","  largedemodata %>%"
"0","  slice(seq(1, n(), 1e2)) %>% "
"0","  # Estimate derivative"
"0","  mutate(dxdt ="
"0","           TVRegDiffR("
"0","             data = obs,"
"0","             iter = 40L,"
"0","             alph = 1e3,"
"0","             scale = ""large"","
"0","             ep = 1e-6,"
"0","             dx = 100"
"0","           )) %>% "
"0","  # Simple numerical integration"
"0","  mutate(dx = lead(x) - x,"
"0","         pred = obs[1] + cumsum(dxdt*dx)) %>% "
"0","  # Collect in long form"
"0","  gather(key, value, -x, -dx)"
"0",""
"0","# Plot observed vs predicted"
"0","ggplot(largeEx %>% "
"0","         filter(key != ""dxdt""), "
"0","       aes(x = x, y = value, color = key, linetype = key)) +"
"0","  geom_line(size = 1.2)"
